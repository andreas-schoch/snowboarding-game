(()=>{"use strict";var e,t,s,i={812:(e,t,s)=>{s.d(t,{b2:()=>p,u:()=>g,v:()=>u});var i=s(260),a=s(479),o=s.n(a);const n={startTerrainHeight:.5,slopeAmplitude:400,slopeLengthRange:[750,1500],worldScale:30,layers:[{color:6065609,width:0},{color:2243451,width:45.5},{color:2960428,width:65},{color:3813938,width:57*1.3},{color:2960428,width:500}]};class r{constructor(e,t,s=n){this.scene=e,this.world=t,this.config=s,this.chunks=[this.scene.add.graphics(),this.scene.add.graphics(),this.scene.add.graphics(),this.scene.add.graphics(),this.scene.add.graphics()],this.slopeStart=new Phaser.Math.Vector2(0,0);const i=new p.b2BodyDef;i.set_type(p.b2_dynamicBody),i.set_position(new p.b2Vec2(0,0)),this.terrainBody=this.world.CreateBody(i),this.generateTerrain()}update(){this.generateTerrain()}interpolate(e,t,s){let i=.5*(1-Math.cos(s*Math.PI));return e*(1-i)+t*i}generateTerrain(){for(;this.slopeStart.x<this.scene.cameras.main.worldView.x+this.scene.cameras.main.width+500;)this.generateSlope()}generateSlope(){let e=[],t=new Phaser.Math.Vector2(0,this.slopeStart.y),s=Phaser.Math.Between(n.slopeLengthRange[0],n.slopeLengthRange[1]);s=200*Math.floor(s/200),s=Math.min(Math.max(s,this.config.slopeLengthRange[0]),this.config.slopeLengthRange[1]);const a=(this.config.slopeLengthRange[1],.75);let r=0===this.slopeStart.x?{x:t.x+1.5*n.slopeLengthRange[1],y:0}:{x:t.x+s,y:Math.random()*a},c=0;for((new i.Display.Color).random();c<=r.x;){let s=this.interpolate(t.y,r.y,(c-t.x)/(r.x-t.x)),i=g.scale.height*n.startTerrainHeight+s*n.slopeAmplitude;e.push(new Phaser.Math.Vector2(c,i)),c++}this.slopePoints=o()(e,1,!1);const l=this.chunks.shift();if(l){this.chunks.push(l),l.clear();for(const{color:e,width:t}of this.config.layers)l.moveTo(this.slopeStart.x,2*g.scale.height),l.fillStyle(e),l.beginPath(),this.slopePoints.forEach((e=>l.lineTo(e.x+this.slopeStart.x,e.y+t))),l.lineTo(this.slopePoints[this.slopePoints.length-1].x+this.slopeStart.x,2*g.scale.height),l.lineTo(this.slopeStart.x,2*g.scale.height),l.closePath(),l.fillPath();l.lineStyle(10,13165035),l.beginPath(),this.slopePoints.forEach((e=>l.lineTo(e.x+this.slopeStart.x,e.y))),l.strokePath(),this.slopeStart.x+=c-1,this.slopeStart.y=r.y}}isEdge(e){return Boolean(e.m_vertex1)}cleanupTerrainFixtures(){for(let e=this.world.GetBodyList();p.getPointer(e)!==p.getPointer(p.NULL);e=e.GetNext())for(let t=e.GetFixtureList();p.getPointer(t)!==p.getPointer(p.NULL);t=t.GetNext()){const s=t.GetShape();this.isEdge(s)&&s.m_vertex2.x*n.worldScale<this.scene.cameras.main.scrollX-900&&e.DestroyFixture(t)}}}class c{constructor(e,t,s){this.isCrashed=!1,this.jump=168,this.boost=30,this.ZERO=new p.b2Vec2(0,0),this.scene=e,this.world=t,this.worldScale=s}create(){return e=this,t=void 0,i=function*(){this.cursors=this.scene.input.keyboard.createCursorKeys(),this.body=this.createBox(500,200,0,50,50,!0)},new((s=void 0)||(s=Promise))((function(a,o){function n(e){try{c(i.next(e))}catch(e){o(e)}}function r(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(n,r)}c((i=i.apply(e,t||[])).next())}));var e,t,s,i}createBox(e,t,s,i,a,o=!0,n=11962192){const r=new p.b2BodyDef;r.set_type(o?p.b2_dynamicBody:p.b2_staticBody),r.set_position(new p.b2Vec2(e/this.worldScale,t/this.worldScale)),r.set_linearDamping(.15),r.set_angularDamping(.1);const c=this.world.CreateBody(r),l=new p.b2PolygonShape;l.SetAsBox(i/2,a/2),c.CreateFixture(l,1);const h=new p.b2MassData;h.set_mass(.5),h.set_center(this.ZERO),h.set_I(1),c.SetMassData(h);let d=this.scene.add.graphics();return d.fillStyle(n),d.fillRect(-i/2,-a/2,i,a),c.userData=d,c}update(){this.body.ApplyForceToCenter(new p.b2Vec2(5,0),!0),this.cursors.left.isDown&&this.body.ApplyForceToCenter(new p.b2Vec2(-5,0),!0),this.cursors.right.isDown&&this.body.ApplyForceToCenter(new p.b2Vec2(5,0),!0),this.cursors.down.isDown&&this.body.ApplyForceToCenter(new p.b2Vec2(0,5),!0),this.cursors.up.isDown&&this.body.ApplyForceToCenter(new p.b2Vec2(0,-5),!0)}}class l extends i.Scene{constructor(){super({key:"GameScene"})}create(){return e=this,t=void 0,i=function*(){console.log("create GameScene");const{width:e,height:t}=g.scale;this.backgroundBack=this.add.tileSprite(0,0,e,t,"space-back").setOrigin(0).setScrollFactor(0,0),this.backgroundMid=this.add.tileSprite(0,0,e,t,"space-mid").setOrigin(0).setScrollFactor(0,0),this.backgroundFront=this.add.tileSprite(0,0,e,t,"space-front").setOrigin(0).setScrollFactor(0,0),this.bgLandscapeMountains=this.add.tileSprite(0,0,e,t,"bg-landscape-4-mountain").setZ(2).setScale(1.25,2).setOrigin(0,.5).setScrollFactor(0,0).setTint(30,30,30,30),this.bgLandscapeHills=this.add.tileSprite(0,0,e,t,"bg-landscape-3-trees").setScale(1.25,1.5).setOrigin(0,.25).setScrollFactor(0,0).setZ(1).setTint(50,50,50,50),this.bgLandscapeClouds=this.add.tileSprite(0,0,e,t,"bg-landscape-5-clouds").setOrigin(0,.3).setScrollFactor(0,0).setZ(1),this.textFPS=this.add.text(this.cameras.main.worldView.x+this.cameras.main.width-24,24,"").setScrollFactor(0).setFontSize(32).setOrigin(1,0),this.textFPS.setShadow(1,1,"#000000",2),setInterval((()=>this.textFPS.setText(`fps: ${this.game.loop.actualFps.toFixed(1)} (${this.game.loop.targetFps})`)),1e3),this.music=this.sound.add("nightmare"),setTimeout((()=>this.music.play({loop:!0,volume:.5,detune:0,rate:1})),1250),this.worldScale=30;let s=new p.b2Vec2(0,0);this.world=new p.b2World(s),console.log("world",this.world,s),this.terrainSimple=new r(this,this.world),this.wickedSnowman=new c(this,this.world,this.worldScale),this.wickedSnowman.create();const i=this.cameras.main.worldView.x+this.cameras.main.width/2,a=this.cameras.main.worldView.y+this.cameras.main.height/2;this.add.text(i+100,a-400,"WICKED SNOWMAN").setScrollFactor(.35).setFontSize(80).setOrigin(.5),this.add.text(i+100,a-200,"Don't lose your head").setScrollFactor(.35).setFontSize(50).setOrigin(.5),this.add.text(i-70,a-125," ↑  jump").setScrollFactor(.35).setFontSize(40).setOrigin(0),this.add.text(i-70,a-75,"← → control").setScrollFactor(.35).setFontSize(40).setOrigin(0),this.playAgainButton=this.add.text(i,a,"PLAY AGAIN?").setScrollFactor(0).setFontSize(50).setOrigin(.5).setPadding(24).setAlpha(0).setStyle({backgroundColor:"#223B7B",border:"5px solid red"}).setInteractive({useHandCursor:!0}).on("pointerdown",(()=>this.restartGame())).on("pointerover",(()=>this.playAgainButton.setStyle({fill:"#5c8dc9"}))).on("pointerout",(()=>this.playAgainButton.setStyle({fill:"#FFF"}))),this.textDistance=this.add.text(24,24,"Travelled: 0m").setScrollFactor(0,0).setFontSize(32),this.textDistance.setShadow(1,1,"#000000",2),this.cameras.main.startFollow(this.wickedSnowman.body.userData,!1,.8,.25),this.cameras.main.followOffset.set(-750,0),this.cameras.main.setDeadzone(100,250),this.cameras.main.setBackgroundColor(0),this.cameras.main.setZoom(1,1)},new((s=void 0)||(s=Promise))((function(a,o){function n(e){try{c(i.next(e))}catch(e){o(e)}}function r(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(n,r)}c((i=i.apply(e,t||[])).next())}));var e,t,s,i}restartGame(){this.music.stop(),this.scene.restart()}update(){this.backgroundBack.setTilePosition(.001*this.cameras.main.scrollX,.001*this.cameras.main.scrollY),this.backgroundMid.setTilePosition(.0025*this.cameras.main.scrollX,.0025*this.cameras.main.scrollY),this.backgroundFront.setTilePosition(.005*this.cameras.main.scrollX,.005*this.cameras.main.scrollY),this.bgLandscapeClouds.setTilePosition(.25*this.cameras.main.scrollX,.25*this.cameras.main.scrollY),this.bgLandscapeMountains.setTilePosition(.025*this.cameras.main.scrollX,0),this.bgLandscapeHills.setTilePosition(.035*this.cameras.main.scrollX,0),console.time("update"),this.wickedSnowman.update(),this.terrainSimple.update(),this.updatePhysics(),console.timeEnd("update")}updatePhysics(){console.time("physics"),this.world.Step(1/40,15,15),this.world.ClearForces();for(let e=this.world.GetBodyList();p.getPointer(e)!==p.getPointer(p.NULL);e=e.GetNext()){if(!e||!e.userData)continue;let t=e.userData;if(!t)continue;let s=e.GetPosition();t.x=s.get_x()*this.worldScale,t.y=s.get_y()*this.worldScale,t.rotation=e.GetAngle()}console.timeEnd("physics")}}class h extends i.Scene{constructor(){super({key:"PreloadScene"})}preload(){return e=this,t=void 0,i=function*(){this.load.audio("nightmare",["assets/audio/nightmare/nightmarechipheavy.mp3","assets/audio/nightmare/nightmarechipheavy.ogg","assets/audio/nightmare/nightmarechipheavy.aac"]),this.load.image("space-back","assets/img/bgSpace/bg_space_seamless.png"),this.load.image("space-mid","assets/img/bgSpace/bg_space_seamless_fl1.png"),this.load.image("space-front","assets/img/bgSpace/bg_space_seamless_fl2.png"),this.load.image("bg-landscape-1-trees","assets/img/bgLandscape/landscape_0000_1_trees.png"),this.load.image("bg-landscape-2-trees","assets/img/bgLandscape/landscape_0001_2_trees.png"),this.load.image("bg-landscape-3-trees","assets/img/bgLandscape/landscape_0002_3_trees.png"),this.load.image("bg-landscape-4-mountain","assets/img/bgLandscape/landscape_0003_4_mountain.png"),this.load.image("bg-landscape-5-clouds","assets/img/bgLandscape/landscape_0004_5_clouds.png"),this.load.image("bg-landscape-6-back","assets/img/bgLandscape/landscape_0005_6_background.png"),console.log("before init b2"),yield u(),console.log("After init b2",this.box2d)},new((s=void 0)||(s=Promise))((function(a,o){function n(e){try{c(i.next(e))}catch(e){o(e)}}function r(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(n,r)}c((i=i.apply(e,t||[])).next())}));var e,t,s,i}create(){console.log("create preloadScene"),this.scene.start("GameScene",this.box2d)}}var d=s(47);let p;function u(){return e=this,t=void 0,i=function*(){p=yield(0,d.Z)({locateFile:()=>"wicked-snowman/assets/Box2D.wasm"})},new((s=void 0)||(s=Promise))((function(a,o){function n(e){try{c(i.next(e))}catch(e){o(e)}}function r(e){try{c(i.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(n,r)}c((i=i.apply(e,t||[])).next())}));var e,t,s,i}const g={type:i.WEBGL,backgroundColor:"#ffffff",disableContextMenu:!0,fps:{min:55,target:60,smoothStep:!0},scale:{parent:"phaser-wrapper",mode:i.Scale.FIT,autoCenter:i.Scale.CENTER_BOTH,width:1920,height:1080},scene:[h,l]};window.addEventListener("load",(()=>{new i.Game(g)}))}},a={};function o(e){var t=a[e];if(void 0!==t)return t.exports;var s=a[e]={exports:{}};return i[e].call(s.exports,s,s.exports,o),s.exports}o.m=i,e=[],o.O=(t,s,i,a)=>{if(!s){var n=1/0;for(h=0;h<e.length;h++){for(var[s,i,a]=e[h],r=!0,c=0;c<s.length;c++)(!1&a||n>=a)&&Object.keys(o.O).every((e=>o.O[e](s[c])))?s.splice(c--,1):(r=!1,a<n&&(n=a));if(r){e.splice(h--,1);var l=i();void 0!==l&&(t=l)}}return t}a=a||0;for(var h=e.length;h>0&&e[h-1][2]>a;h--)e[h]=e[h-1];e[h]=[s,i,a]},o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var s in t)o.o(t,s)&&!o.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},o.f={},o.e=e=>Promise.all(Object.keys(o.f).reduce(((t,s)=>(o.f[s](e,t),t)),[])),o.u=e=>e+"."+{100:"6492ee9eda8c8726e98b",529:"368799123cf63121a22a"}[e]+".chunk.js",o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),t={},s="wicked-snowman:",o.l=(e,i,a,n)=>{if(t[e])t[e].push(i);else{var r,c;if(void 0!==a)for(var l=document.getElementsByTagName("script"),h=0;h<l.length;h++){var d=l[h];if(d.getAttribute("src")==e||d.getAttribute("data-webpack")==s+a){r=d;break}}r||(c=!0,(r=document.createElement("script")).charset="utf-8",r.timeout=120,o.nc&&r.setAttribute("nonce",o.nc),r.setAttribute("data-webpack",s+a),r.src=e),t[e]=[i];var p=(s,i)=>{r.onerror=r.onload=null,clearTimeout(u);var a=t[e];if(delete t[e],r.parentNode&&r.parentNode.removeChild(r),a&&a.forEach((e=>e(i))),s)return s(i)},u=setTimeout(p.bind(null,void 0,{type:"timeout",target:r}),12e4);r.onerror=p.bind(null,r.onerror),r.onload=p.bind(null,r.onload),c&&document.head.appendChild(r)}},o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;o.g.importScripts&&(e=o.g.location+"");var t=o.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var s=t.getElementsByTagName("script");s.length&&(e=s[s.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),o.p=e})(),(()=>{o.b=document.baseURI||self.location.href;var e={179:0};o.f.j=(t,s)=>{var i=o.o(e,t)?e[t]:void 0;if(0!==i)if(i)s.push(i[2]);else{var a=new Promise(((s,a)=>i=e[t]=[s,a]));s.push(i[2]=a);var n=o.p+o.u(t),r=new Error;o.l(n,(s=>{if(o.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var a=s&&("load"===s.type?"missing":s.type),n=s&&s.target&&s.target.src;r.message="Loading chunk "+t+" failed.\n("+a+": "+n+")",r.name="ChunkLoadError",r.type=a,r.request=n,i[1](r)}}),"chunk-"+t,t)}},o.O.j=t=>0===e[t];var t=(t,s)=>{var i,a,[n,r,c]=s,l=0;if(n.some((t=>0!==e[t]))){for(i in r)o.o(r,i)&&(o.m[i]=r[i]);if(c)var h=c(o)}for(t&&t(s);l<n.length;l++)a=n[l],o.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return o.O(h)},s=self.webpackChunkwicked_snowman=self.webpackChunkwicked_snowman||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})();var n=o.O(void 0,[216],(()=>o(812)));n=o.O(n)})();